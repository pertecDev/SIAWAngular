<section
  style="background-color:#ffe0c0 !important;margin-left: 1px;padding: 5px;margin-right: 7.5px;flex: 1;box-sizing: border-box;">
  <ngx-spinner bdColor="rgba(251, 216, 0, 0.8)" size="medium" color="#093070" type="square-loader" [fullScreen]="true">
    <br>
    <p style="font-size: 25px; color: rgb(9,48,112,)">ðŸ”© Cargando... ðŸ”©</p>
  </ngx-spinner>
  
  <p-toast></p-toast>

  <div class="row mb-2">
    <div class="col">
      <div class="divTable">
        <div class="input-group-append text-center" style="float: left;">
          <!-- BOTONES -->
          <div class="input-group-append">
            <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1" (click)="alMenu();">
              <span><i class="fa fa-arrow-left" aria-hidden="true" style="color: #ffc107;"></i> Menu</span>
            </button> | &nbsp;

            <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1" (click)="validar();">
              <span><i class="fa fa-save" aria-hidden="true" style="color: #7d99c7;"></i> Grabar</span>
            </button>

            <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1" type="button"
              (click)="limpiar()">
              <span><i class="fa fa-eraser" aria-hidden="true" style="color: #ffc107;"></i> Limpiar</span>
            </button>

            <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1" type="button"
            (click)="tranferirModal()">
              <span><i class="fa fa-clone" aria-hidden="true" style="color: #7d99c7;"></i> Transferir</span>
            </button>

            <!-- <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1" type="button">
              <span>
                <mat-icon
                  style="color: #664f09d7;font-size: 0.9rem !important;height: 13px !important;width: 16px !important;">
                  account_balance_wallet</mat-icon> Notas del Ticket
              </span>
            </button> -->

            <!-- <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1" type="button"
              (click)="exportProformaExcel();">
              <span>Exportar Proforma</span>
            </button> -->

            <!--<button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1" type="button">
              <span><i class="fa fa-file-excel green" aria-hidden="true" style="color: #05970c;"></i>
                Cargar</span>
            </button> -->

            <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1"
              (click)="soloValidar();" type="button">
              <span> <i class="fa fa-eye" aria-hidden="true" style="color: #ffc107;"></i> Validar</span>
            </button>
          </div>

          <div class="pt-1" style="padding-left: 100px !important;">
            <h3><strong><u>FACTURACION MOSTRADOR (FEL)</u></strong></h3>
          </div>
          <!-- BOTONES FIN -->
        </div> 

        <div class="input-group-append text-center" style="float: right;">          
          <button class="btn btn-outline-secondary form-control-sm" type="button" (click)="modalMatrizClasica()"
              matTooltip="Matriz Item Clasica" matTooltipClass="custom-tooltip" matTooltipPosition="above">
              <i class="fa fa-th gray" aria-hidden="true"></i>
          </button>
          
          <!-- <button class="btn btn-outline-secondary form-control-sm" type="button" matTooltip="Matriz Item Vendedores"
            matTooltipClass="custom-tooltip" matTooltipPosition="above" (click)="modalMatrizProductos()">
            <i class="fa fa-th blue" aria-hidden="true"></i>
          </button> -->
          <button class="btn btn-outline-secondary form-control-sm" type="button" (click)="empaquesCerradosValidacion();"
            matTooltip="Empaques Multiplos Cerrados" matTooltipClass="custom-tooltip" matTooltipPosition="above">
            <i class="fa fa-inbox gray" aria-hidden="true"></i>
          </button>
          <!-- <button class="btn btn-outline-secondary form-control-sm" type="button" matTooltip="Estado Mora"
            matTooltipClass="custom-tooltip" matTooltipPosition="above">
            <mat-icon class="red">photo_size_select_small</mat-icon>
          </button> -->
          <!-- <button class="btn btn-outline-secondary form-control-sm" type="button" matTooltip="Pagos Cliente"
            matTooltipClass="custom-tooltip" matTooltipPosition="above">
            <mat-icon class="blue">photo_size_select_small</mat-icon>
          </button> -->
          <button class="btn btn-outline-secondary form-control-sm" type="button" matTooltip="Validar Negativos"
            (click)="validarProformaSoloNegativos();" matTooltipClass="custom-tooltip" matTooltipPosition="above">
            <i class="fa fa-inbox blue" aria-hidden="true"></i>
          </button>
          <!-- <button class="btn btn-outline-secondary form-control-sm" type="button">
            <i class="fa fa-question-circle black" aria-hidden="true"></i>
          </button> -->
          
          <button class="btn btn-outline-secondary form-control-sm" type="button" matTooltipClass="custom-tooltip" 
            (click)="empaquesMinimosPrecioValidacion()" matTooltip="Validar Empaques Minimo de Precio" matTooltipPosition="above">
            <i class="fa fa-inbox red" aria-hidden="true"></i>
          </button>

          <button mat-button [matMenuTriggerFor]="beforeMenu">
            <mat-icon>expand_more</mat-icon>
          </button>

          <mat-menu #beforeMenu="matMenu" xPosition="before">
            <mat-list role="list">
              <!-- <mat-list-item role="listitem" class="list-button"> -->
              <!-- <button class="btn btn-outline-secondary form-control-sm" type="button">
                  <i class="fa fa-window-restore blue" aria-hidden="true"></i> 
                </button> -->
              <!-- </mat-list-item> -->
              <mat-list-item role="listitem" class="list-button">
                <button class="btn btn-outline-secondary form-control-sm" type="button"
                  (click)="detalleProformaCarritoTOExcel();">
                  <i class="fa fa-paper-plane" aria-hidden="true"></i> Detalle a Excel
                </button>
              </mat-list-item>
              <mat-list-item role="listitem" class="list-button">
                <button class="btn btn-outline-secondary form-control-sm" type="button"
                  (click)="cargarDataExcel();">
                  <i class="fa fa-file-excel green" aria-hidden="true"></i> Cargar
                </button>
              </mat-list-item>
            </mat-list>
          </mat-menu>
        </div>
      </div>
    </div>
  </div>

  <!-- cabecera -->
  <!-- primeraLinea -->
  <form class="example-form" [formGroup]="FormularioData">
    <!-- btns -->
    <div class="row">
      <div class="col-md-2" style="padding-right: 0px;padding-left: 6.5px;">
        <div class="input-group">
          <div class="input-group-">
            <span class="input-group-text form-control-sm" style="padding: 10px 27px 0px 0px;border: 0 !important;">
              <u>
                <div *ngIf="submitted && f.codalmacen.invalid" class="invalid-feedback">
                  <mat-icon matTooltipClass="custom-tooltip" matTooltip="Validar Almacen">info</mat-icon>
                </div> Almacen
              </u>
            </span>
          </div>
          <ng-container>
            <input type="text" class="form-control form-control-sm" [(ngModel)]="almacn_parame_usuario_almacen"
              formControlName="codalmacen" id="inputCatalogoAlmacen" (blur)="onLeaveAlmacen($event)"
              style="margin-left: 6px;background-color: black;color: #ffc107;" readonly>
          </ng-container>

          <div class="input-group-append">
            <!-- <button class="btn btn-outline-primary form-control-sm" type="button" (click)="modalAlmacen();"
              style="border-color: #093070;" matTooltipClass="custom-tooltip" matTooltip="Buscar Almacen"
              [disabled]="false"><i class="fa fa-search"></i>
            </button> -->
          </div>
        </div>
      </div>

      <div class="col-md-1" style="padding-right: 0px;padding-left: 6.5px;">
        <div class="input-group">
          <div class="input-group-">
            <span class="input-group-text form-control-sm" style="padding: 10px 0px 0px 0px;border: 0 !important;">
              <div *ngIf="submitted && f.nrocaja.invalid" class="invalid-feedback">
                <mat-icon style="height: 22px !important;" matTooltipClass="custom-tooltip"
                matTooltip="Validar Caja">info</mat-icon>
              </div> 
              <u> Caja </u>
            </span>
          </div>
          <ng-container>
            <input type="text" class="form-control form-control-sm" style="margin-left: 6px;background-color: black;color: #ffc107;"
              [(ngModel)]="nrocaja" formControlName="nrocaja" 
              [class.is-invalid]="f.nrocaja.invalid && (f.nrocaja.dirty || f.nrocaja.touched)" readonly>
          </ng-container>

          <div class="input-group-append">
            <button class="btn btn-outline-primary form-control-sm" type="button" (click)="generarFactura();"
              style="border-color: #093070;" matTooltipClass="custom-tooltip" matTooltip="Buscar Almacen"
              [disabled]="false"><i class="fa fa-plug"></i>
            </button>
          </div>
        </div>
      </div>

      <div class="col-md-3" style="padding-right: 0px;padding-left: 6.5px;">
        <div class="input-group">
          <div class="input-group-">
            <span class="input-group-text form-control-sm" style="padding: 10px 0px 0px 0px;border: 0 !important;">
              <u>
                <div *ngIf="submitted && f.codalmacen.invalid" class="invalid-feedback">
                  <mat-icon matTooltipClass="custom-tooltip" matTooltip="Validar Almacen">info
                  </mat-icon>
                </div> CUFD
              </u>
            </span>
          </div>
          <ng-container>
            <input type="text" class="form-control form-control-sm" [(ngModel)]="CUFD" formControlName="CUFD"
              style="margin-left: 6px;background-color: black;color: #ffc107;" readonly>
          </ng-container>
        </div>
      </div>

      <div class="col-md-2" style="padding-right: 0px;padding-left: 6.5px;">
        <div class="input-group">
          <div class="input-group-">
            <span class="input-group-text form-control-sm" style="padding: 10px 0px 0px 0px;border: 0 !important;">
              <u>
                <div *ngIf="submitted && f.codalmacen.invalid" class="invalid-feedback">
                  <mat-icon matTooltipClass="custom-tooltip" matTooltip="Validar Almacen">info
                  </mat-icon>
                </div> Cod. Control
              </u>
            </span>
          </div>
          <ng-container>
            <input type="text" class="form-control form-control-sm" [(ngModel)]="codigo_control_get"
              formControlName="codigo_control"
              style="margin-left: 6px;background-color: black;color: #ffc107;" readonly>
          </ng-container>
        </div>
      </div>

      <div class="col-md-2" style="padding-right: 0px;padding-left: 6.5px;">
        <div class="input-group">
          <div class="input-group-">
            <span class="input-group-text form-control-sm" style="padding: 10px 0px 0px 0px;border: 0 !important;">
              <u>
                <div *ngIf="submitted && f.codalmacen.invalid" class="invalid-feedback">
                  <mat-icon matTooltipClass="custom-tooltip" matTooltip="Validar Almacen">info
                  </mat-icon>
                </div> Fecha Lim
              </u>
            </span>
          </div>
          <ng-container>
            <input type="text" class="form-control form-control-sm" [(ngModel)]="dtpfecha_limite_get"
              formControlName="fechalimite" 
              style="margin-left: 6px;background-color: black;color: #ffc107;" readonly>
          </ng-container>
        </div>
      </div>

      <div class="col-md-1"></div>

      <div class="col-md-1" style="padding-right: 0px;padding-left: 6.5px; float: right;">
        <div class="input-group">
          <div class="input-group-">
            <span class="input-group-text form-control-sm" style="padding: 10px 0px 0px 0px;border: 0 !important;">
              <u>
                <div *ngIf="submitted && f.codalmacen.invalid" class="invalid-feedback">
                  <mat-icon matTooltipClass="custom-tooltip" matTooltip="Validar Almacen">info
                  </mat-icon>
                </div> Nro.
              </u>
            </span>
          </div>
          <ng-container>
            <div style="width: 71px;">
              <input type="text" class="form-control form-control-sm" [(ngModel)]="nrolugar_get"
              formControlName="nrolugar_get"
              style="margin-left: 6px;background-color: black;color: #ffc107;" readonly>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
    <!-- fin btns -->
   
    <!-- cabecera -->
    <div class="mat-elevation-z2 row">
      <!-- primeraColumna -->
      <div class="col-md-3 col-lg-3 col-sm-4">
        <div class="row">
          <div class="col-md-8" style="padding-right: 0px;padding-left: 6.5px;">
            <div class="input-group">
              <div class="input-group-">
                <span class="input-group-text form-control-sm" style="padding: 10px 42px 0px 0px;">
                  <u> ID Tipo </u>
                </span>
              </div>

              <ng-container>
                <input type="text" class="form-control form-control-sm" id="id_factura_input"
                formControlName="id" [(ngModel)]="id_factura" style="font-weight:bold;">
              </ng-container>
              <div class="input-group-append">
                <button class="btn btn-outline-primary form-control-sm" type="button" style="border-color: #093070;"
                  matTooltip="Buscar ID" (click)="modalTipoID()"><i class="fa fa-search"></i>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-8" style="padding-right: 0px !important;padding-left: 0px !important;">
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text form-control-sm"
                style="padding: 10px 0px 0px 0px;border: 0 !important;"><u>Documento No </u></span>
              <div class="input-group">
                <input type="text" class="form-control form-control-sm" formControlName="numeroid"
                [(ngModel)]="documento_nro" [readonly]="true">
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-8" style="padding-right: 0px !important;padding-left: 0px !important;">
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text form-control-sm"
                style="padding: 10px 26px 0px 0px;border: 0 !important;"><u>Fecha</u></span>
            </div>
            <input type="text" class="form-control form-control-sm" style="margin-left: 21px;" formControlName="fecha"
              [readOnly]="true" [(ngModel)]="fecha_actual">
              <input type="text" formControlName="fechareg" [(ngModel)]="fecha_actual" hidden>
              <input type="text" formControlName="hora" [(ngModel)]="hora_fecha_server" hidden>
              <input type="text" formControlName="hora_inicial" [(ngModel)]="hora_fecha_server" hidden>
              <input type="text" formControlName="horareg" [(ngModel)]="hora_fecha_server" hidden>
              <input type="text" formControlName="horareg" [(ngModel)]="hora_fecha_server" hidden>
              <input type="text" formControlName="usuarioreg" [(ngModel)]="usuarioLogueado" hidden>
              <input type="text" formControlName="horaaut" [(ngModel)]="hora_fecha_server" hidden>
              <input type="text" formControlName="fecha_inicial" [(ngModel)]="fecha_actual" hidden>
          </div>
        </div>

        <div class="row">
          <div class="col-md">
            <div class="input-group">
              <div class="input-group-">
                <span class="input-group-text form-control-sm" style="padding: 10px 29px 0px 0px;border: 0 !important;">
                  <div *ngIf="submitted && f.codvendedor.invalid" class="invalid-feedback">
                    <mat-icon style="height: 22px !important;" matTooltipClass="custom-tooltip"
                      matTooltip="Validar Vendedor">info</mat-icon>
                  </div>
                  <u>Vendedor</u>
                </span>
              </div>

              <ng-container>
                <!-- <div class="input-group-append"> -->
                  <input type="password" class="form-control form-control-sm" formControlName="codigo_secreto_vendedor"
                  [(ngModel)]="codigo_secreto_vendedor" id="inputClaveSecretaVendedor" placeholder="COD. SECRETO"
                  [class.is-invalid]="f.codvendedor.invalid && (f.codvendedor.dirty || f.codvendedor.touched)">


                  <button class="btn btn-outline-primary form-control-sm" type="button" (click)="getCodigoVendedor(codigo_secreto_vendedor);"
                    style="border-color: #093070;" matTooltipClass="custom-tooltip" matTooltip="Buscar Vendedor">
                    <i class="fa fa-search"></i>
                  </button>
                <!-- </div> -->
              </ng-container>

              <input type="text" class="form-control form-control-sm" formControlName="codvendedor" readonly
              [(ngModel)]="codigo_vendedor" [class.is-invalid]="f.codvendedor.invalid && (f.codvendedor.dirty || f.codvendedor.touched)">
            </div>
          </div>
        </div>

        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm"
              style="padding: 10px 10px 0px 0px;border: 0 !important;"><u>Cta. Ingreso </u></span>
          </div>
          <input type="text" class="form-control form-control-sm" style="margin-left: 6px;" formControlName="cta_ingreso"
          [(ngModel)]="cta_ingreso" [readOnly]="true">
        </div>
        
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm"
              style="padding: 9px 47px 3px 0px;border: 0 !important;"><u>Ticket </u></span>
          </div>

          <input type="text" class="form-control form-control-sm" style="margin-left: 2px;"
            formControlName="nroticket" placeholder="Ticket" [(ngModel)]="nroticket">
         
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm"
              style="padding: 9px 3px 0px 32px;border: 0 !important;"><u>Moneda </u></span>
          </div>
          <input type="text" class="form-control form-control-sm" id="inputMoneda" formControlName="codmoneda"
          [(ngModel)]="moneda_get_catalogo" placeholder="Moneda" readonly>
          
          <div class="input-group-append">
            <button class="btn btn-outline-primary form-control-sm" type="button" (click)="modalCatalogoMoneda();"
              style="border-color: #093070;" disabled><i class="fa fa-search"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- segundaColumna -->
      <div class="col-md-3 col-lg-3 col-sm-4">        <!-- <div class="input-group"> -->
        <div class="input-group-prepend">
          <span class="input-group-text form-control-sm" style="padding: 3px 10px 4px 24px;border: 0 !important;">
            <u>Es Contra Entrega</u></span>
          <input type="checkbox" formControlName="contra_entrega" [(ngModel)]="contra_entrega">  
        </div>        
       
        <div class="input-group">
          <span class="input-group-text form-control-sm"
            style="padding: 8px 4px 0px 45px !important;border: 0 !important;">
            <div *ngIf="submitted && f.tipopago.invalid" class="invalid-feedback">
              <mat-icon matTooltipClass="custom-tooltip" matTooltip="Validar Tipo de Pago">info</mat-icon>
            </div>
            <u> Tipo de Venta </u>
          </span>
          <mat-select class="custom-select1 form-control-sm" placeholder="SELECCIONAR..." 
            [(ngModel)]="tipopago" formControlName="tipopago"
            [class.is-invalid]="f.tipopago.invalid && (f.tipopago.dirty || f.tipopago.touched)">
            <mat-option [value]=0>CONTADO</mat-option>
            <mat-option [value]=1>CREDITO</mat-option>
          </mat-select>
        </div>

        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm"
              style="padding: 10px 6px 0px 27px;border: 0 !important;"><u>Precio de Ventas</u> </span>
          </div>

          <ng-container>
            <input type="number" class="form-control form-control-sm" [(ngModel)]="cod_precio_venta_modal_codigo"
            (blur)="onLeavePrecioVenta($event)" id="inputCatalogoPrecioVenta" formControlName="preciovta">
          </ng-container>

          <div class="input-group-append">
            <a class="btn btn-outline-primary form-control-sm" style="border-color: #093070;" 
              (click)="modalPrecioVentaDetalle();"> <i class="fa fa-search"></i>
            </a>
            <a class="btn btn-outline-primary form-control-sm" style="border-color: #093070;" (click)="aplicarPrecioVenta(cod_precio_venta_modal_codigo)">
              <i class="fa fa-cog"></i> Aplicar
            </a>
          </div>
        </div>

        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm"
              style="padding: 10px 4px 0px 25px;border: 0 !important;"><u>Desct. Especiales</u> </span>
          </div>

          <ng-container>
            <input type="number" class="form-control form-control-sm" [(ngModel)]="cod_descuento_modal"
            id="inputCatalogoDesctEspecial" (blur)="onLeaveDescuentoEspecial($event)" formControlName="descuentos">
          </ng-container>

          <div class="input-group-append">
            <a class="btn btn-outline-primary form-control-sm" type="button" style="border-color: #093070;"
              (click)="modalDescuentoEspecial();">
              <i class="fa fa-search"></i>
            </a>
            <a class="btn btn-outline-primary form-control-sm" type="button" style="border-color: #093070;"
              (click)="aplicarDesctEspc(cod_descuento_modal);"><i class="fa fa-cog"></i> Aplicar
            </a>
          </div>
        </div>
      </div>

      <!-- terceraColumna -->
      <div class="col-md-2 col-lg-2  col-sm-0">
      </div>

      <!-- cuartaColumna -->
      <div class="col-md-4 col-lg-4 col-sm-4" style="float: right;">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm" style="padding: 9px 0px 0px 18px;border: 0 !important;">
              <div *ngIf="submitted && f.codcliente.invalid" class="invalid-feedback">
                <mat-icon matTooltipClass="custom-tooltip" matTooltip="Validar Cliente">info</mat-icon>
              </div>
              <u> Cod. Cliente </u>
            </span>
          </div>

          <div style="width: 80px;">
            <input type="text" class="form-control cliente form-control-sm" formControlName="codcliente"
            [(ngModel)]="codigo_cliente" style="margin-left: 6.5px;background-color: black;color:#ffc107"
            id="inputCatalogoCliente" placeholder="COD. CLIENTE" #cod_cliente
            [class.is-invalid]="f.codcliente.invalid && (f.codcliente.dirty || f.codcliente.touched)">
            <div *ngIf="submitted && f.nit.invalid" class="invalid-feedback"></div>
          </div>
          
          <div class="input-group-append">
            <span class="input-group-text form-control-sm" (click)="modalCatalogoClientes();" style="cursor: pointer; border: 1;">
              <i class="fa fa-search" aria-hidden="true" style="color: #093070;"></i>
            </span>
            <span class="input-group-text form-control-sm" (click)="mandarCodCliente(codigo_cliente);"
              style="cursor: pointer; border: 1;">
              <i class="fa fa-eye" aria-hidden="true" style="color: #093070;"></i>
            </span>
          </div>

          <input type="text" class="form-control form-control-sm" placeholder="Nombre Cliente" readonly
            formControlName="nomcliente" [(ngModel)]="razon_social" style="background-color: black;color:#ffc107">
        </div>

        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm"
              style="padding: 7px 5px 0px 0px;border: 0 !important;"><u>Nombre Factura </u></span>
          </div>
         
          <input type="text" class="form-control form-control-sm" [(ngModel)]="razon_social"
            formControlName="nomcliente" style="background-color: black;color:#ffc107" [readonly]="!codigo_cliente?.startsWith('SN')">
 
          <div class="input-group-append">
            <button class="btn btn-outline-primary form-control-sm" type="button" style="border-color: #093070;"
              [disabled]="!codigo_cliente?.startsWith('SN')" (click)="guardarNombreCliente();"
              matTooltip="Guardar Cliente" matTooltipClass="custom-tooltip" matTooltipPosition="above"><i class="fa fa-save"></i>
            </button>
          </div>
        </div>

        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm" style="padding: 9px 3px 2px 42px;border: 0 !important;">
              <div *ngIf="submitted && f.tipo_docid.invalid" class="invalid-feedback">
                <mat-icon matTooltipClass="custom-tooltip" matTooltip="Validar Doc Id">info</mat-icon>
              </div>
              <u> Doc. Id.</u>
            </span>
          </div>
         
          <mat-select class="custom-select form-control-sm" formControlName="tipo_docid" style="margin-left: 3px;padding: 0px 0px 0px 5px !important;" 
          [readonly]="!codigo_cliente?.startsWith('SN')" [(ngModel)]="tipo_doc_cliente" [value]="tipo_doc_cliente"
          [class.is-invalid]="f.tipo_docid.invalid && (f.tipo_docid.dirty || f.tipo_docid.touched)">
            <mat-option *ngFor="let documento_identidads of documento_identidad"
              [value]="documento_identidads.codigoclasificador">
              {{ documento_identidads.codigoclasificador }} - {{ documento_identidads.descripcion }}</mat-option>
          </mat-select>
        </div>

        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm" style="padding: 8px 6px 0px 41px;border: 0 !important;">
              <div *ngIf="submitted && f.nit.invalid" class="invalid-feedback">
                <mat-icon matTooltipClass="custom-tooltip" matTooltip="Validar NIT">info</mat-icon>
              </div>
              <u><i class="fa fa-eye" (click)="verificarNit()" style="cursor:pointer"></i> N.I.T</u>
            </span>

            <!-- <ng-container *ngIf="razon_social !== 'SIN NOMBRE';"> -->
            <!-- <input type="text" class="form-control form-control-sm" formControlName="nit" placeholder="N.I.T."
              [(ngModel)]="nit_cliente" style="margin-left: 3px;" (paste)="onPaste($event)"
              [readonly]="!codigo_cliente?.startsWith('SN')"  (keypress)="onlyNumbers($event)" 
              (paste)="onPasteNIT($event)"
              [class.is-invalid]="f.nit.invalid && (f.nit.dirty || f.nit.touched)"> -->
            <!-- </ng-container> -->
            <div *ngIf="submitted && f.nit.invalid" class="invalid-feedback"></div>
          </div>

          <container-element [ngSwitch]="tipo_doc_cliente" style="width: 80%;">
            <!-- CI/NIT  VALIDAR QUE SOLO SEAN NUMEROS -->
            <!-- CEX - CEDULA DE IDENTIDAD EXTRANJERO PAS - PASOPORTE OTRO-DOCUMENTO -->
            <ng-container *ngSwitchCase="1">
              <div class="input-group-prepend">
                <!-- <input type="number" class="form-control form-control-sm" placeholder="CI - CEDULA DE IDENTIDAD"
                  style="font-size: 0.55rem !important;width: 80%;" [(ngModel)]="valor_nit" min="0" hidden> -->
                <input type="number" class="form-control form-control-sm" formControlName="nit" placeholder="CARNET IDENTIDAD"
                  [readonly]="!codigo_cliente?.startsWith('SN')" (paste)="onPaste($event)"
                  [(ngModel)]="nit_cliente" style="width: 66%;" [class.is-invalid]="f.nit.invalid && (f.nit.dirty || f.nit.touched)">
                  <div *ngIf="submitted && f.nit.invalid" class="invalid-feedback"></div>
                  <input type="text" class="form-control form-control-sm" formControlName="complemento_ci" placeholder="COMPLEMENTO"
                  [(ngModel)]="complemento_ci" [readonly]="!codigo_cliente?.startsWith('SN')" style="width: 34%;">
              </div>
            </ng-container>
            <ng-container *ngSwitchCase="2">
              <input type="text" class="form-control form-control-sm" (paste)="onPaste($event)" formControlName="nit"
                placeholder="CEX - CÃ‰DULA DE IDENTIDAD DE EXTRANJERO" [readonly]="!codigo_cliente?.startsWith('SN')"
                style="width: 100%;font-size: 0.55rem !important;" [(ngModel)]="nit_cliente" [class.is-invalid]="f.nit.invalid && (f.nit.dirty || f.nit.touched)" >
                <div *ngIf="submitted && f.nit.invalid" class="invalid-feedback"></div>
            </ng-container>
            <ng-container *ngSwitchCase="3">
              <input type="text" class="form-control form-control-sm" placeholder="PAS - PASAPORTE" (paste)="onPaste($event)" formControlName="nit"
                style="font-size: 0.55rem !important;width: 100%;" [(ngModel)]="nit_cliente" [readonly]="!codigo_cliente?.startsWith('SN')"
                [class.is-invalid]="f.nit.invalid && (f.nit.dirty || f.nit.touched)"> <div *ngIf="submitted && f.nit.invalid" class="invalid-feedback"></div>
            </ng-container>
            <ng-container *ngSwitchCase="4">
              <input type="text" class="form-control form-control-sm" (paste)="onPaste($event)" formControlName="nit"
                placeholder="OD - OTRO DOCUMENTO DE IDENTIDAD" style="font-size: 0.55rem !important;width: 100%;"
                [(ngModel)]="nit_cliente" [readonly]="!codigo_cliente?.startsWith('SN')" [class.is-invalid]="f.nit.invalid && (f.nit.dirty || f.nit.touched)" >
                <div *ngIf="submitted && f.nit.invalid" class="invalid-feedback"></div>
            </ng-container>
            <ng-container *ngSwitchCase="5">
              <input type="number" class="form-control form-control-sm" (paste)="onPaste($event)" formControlName="nit"
                placeholder="NIT - NÃšMERO DE IDENTIFICACIÃ“N TRIBUTARIA" min="0" [readonly]="!codigo_cliente?.startsWith('SN')"
                style="width: 100%;font-size: 0.55 rem !important;" [(ngModel)]="nit_cliente" [class.is-invalid]="f.nit.invalid && (f.nit.dirty || f.nit.touched)">
                <div *ngIf="submitted && f.nit.invalid" class="invalid-feedback"></div>
            </ng-container>
          </container-element>
        </div>

        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm" style="padding: 10px 3px 0px 45px;border: 0 !important;"><u
                (click)="setEmailDefault();" style="cursor: pointer;"> 
                <i class="fa fa-magic" (click)="setEmailDefault();" style="cursor: pointer;" aria-hidden="true"></i>Email </u></span>
          </div>
          <ng-container *ngIf="!email_cliente ">
            <input type="email" class="form-control form-control-sm" formControlName="email" style="margin-left: 4px;"
              style="margin-left: 2px;" [value]="" [(ngModel)]="email" [class.is-invalid]="f.email.invalid &&
                (f.email.dirty || f.email.touched)" style="background-color: black;color:#ffc107">
            <div *ngIf="submitted && f.email.invalid" class="invalid-feedback"></div>
          </ng-container>

          <ng-container *ngIf="email_cliente">
            <input type="email" class="form-control form-control-sm" formControlName="email" [(ngModel)]="email_cliente"
              style="margin-left: 2px;" [class.is-invalid]="f.email.invalid && (f.email.dirty
                || f.email.touched)" style="background-color: black;color:#ffc107">
            <div *ngIf="submitted && f.email.invalid" class="invalid-feedback"></div>
          </ng-container>

          <div class="input-group-append">
            <button class="btn btn-outline-primary form-control-sm" type="button" style="border-color: #093070;"
            matTooltip="Actualizar Correo" matTooltipClass="custom-tooltip" matTooltipPosition="above"
              (click)="guardarCorreo();" [disabled]="!email_cliente"><i class="fa fa-save"></i>
            </button>
          </div>
        </div>

        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text form-control-sm"
              style="padding: 9px 3px 0px 33px;border: 0 !important;"><u>Whatsapp </u></span>
          </div>

          <input type="text" class="form-control form-control-sm" formControlName="celular" style="margin-left: 2px;"
            [(ngModel)]="whatsapp_cliente" style="background-color: black;color:#ffc107">
        </div>
      </div>
    </div>
  </form>
  <!-- finCabezera -->

  <!-- InicioTabla -->
  <div class="row">
    <div class="col">
      <mat-tab-group class="miTabGroupDetalle" #tabGroup>
        <mat-tab label="Detalle del Pedido">
          <p-table [value]="array_items_carrito_y_f4_catalogo" [tableStyle]="{'min-width': '60rem'}"
            styleClass="p-datatable-striped tablitaDetalle" [metaKeySelection]="true" selectionMode="multiple"
            [(selection)]="selectedProducts" dataKey="coditem" sortMode="multiple" (onRowSelect)="onRowSelect($event)"
            (onRowUnselect)="onRowUnselect($event)">
          <ng-template pTemplate="header">
            <tr>
              <!-- <th pSortableColumn="nroitem" class="center1" style="width:2%;">
                OrdP
              </th> -->
              <th pSortableColumn="orden" class="center1" style="width:4%;">
                Orden
                <p-sortIcon class="iconGrid" field="orden" />
              </th>
              <th pSortableColumn="item" style="width:9%;" class="center1" (click)="modalCatalogoProductos()"
                style="text-align: center !important; cursor: pointer;">
                <i class="fa fa-plus" style="text-align: center !important; cursor: pointer;"></i>&nbsp;
                <u>Item</u>
                <p-sortIcon field="item" />
              </th>
              <th pSortableColumn="descripcion" style="width:24%;" class="center">
                DescripciÃ³n
                <p-sortIcon field="descripcion" />
              </th>
              <th pSortableColumn="medida" class="center1" style="width:10%">
                Medida
              </th>
              <th pSortableColumn="ud" class="center1" style="width:3%">
                Ud
              </th>
              <th pSortableColumn="iva" class="center1" style="width:2%">
                %IVA
              </th>
              <!-- <th pSortableColumn="empaque" class="center1">
                Empaque
              </th> -->
              <!-- <th pSortableColumn="pedido" class="center1">
                Pedido
                <p-sortIcon field="pedido" />
              </th> -->
              <th pSortableColumn="cantidad" class="center1">
                Cantidad
                <p-sortIcon field="cantidad" />
              </th>
              <!-- <th pSortableColumn="sld" class="right">
                % SLD
              </th> -->
              <th pSortableColumn="TP" class="center1">
                TP
                <p-sortIcon field="TP" />
              </th>
              <th pSortableColumn="DE" class="center1">
                DE
                <p-sortIcon field="DE" />
              </th>
              <th pSortableColumn="PUL" class="right1" style="width:4%">
                PUL
              </th>
              <th pSortableColumn="NIV" class="right1" style="width:3%">
                NIV
              </th>
              <!-- <th pSortableColumn="%" class="right1" style="width:3%">
                %
              </th> -->
              <th pSortableColumn="PD" class="right1" style="width:9%">
                PD
              </th>
              <th pSortableColumn="PU" class="right1" style="width:9%">
                PU
              </th>
              <th pSortableColumn="%" class="right1" style="width:9%">
                Total
                <p-sortIcon field="Total"/>
              </th>
            </tr>
          </ng-template>

          <ng-template pTemplate="body" let-products let-rowIndex="rowIndex">
            <tr [pSelectableRow]="products" [pSelectableRowIndex]="rowIndex" [ngStyle]="{height: '10px'}"
              (click)="itemDataAll(products?.coditem)">
              <td class="center1">
                <i class="fa fa-trash" style="font-size: 0.6rem !important;color:rgb(222, 12, 12) !important;cursor:pointer;
                  padding-block-start: 3px;" (click)="eliminarItemTabla(products?.orden, products?.coditem);">
                </i>
                {{ products.orden }}
              </td>
              <td class="center1">{{ products.coditem }}</td>
              <td class="left">{{ products.descripcion }}</td>
              <td class="center1">{{ products.medida }}</td>
              <td class="center1">{{ products.udm }}</td>
              <td class="center1">{{ products.porceniva }}</td>

              <!-- COLUMNA EMPAQUE -->
              <!-- <td class="center1" [pEditableColumn]="products.empaque" pEditableColumnField="empaque">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input pInputText type="number" min="0" [(ngModel)]="products.empaque"
                      style="text-align: center !important;"
                      (input)="onInputChangeMatrix(products, $event.target.value)" />
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{ products.empaque }}
                  </ng-template>
                </p-cellEditor>
              </td> -->

              <!-- COLUMNA PEDIDO -->
              <!-- <td class="center1" [pEditableColumn]="products.cantidad_pedida"
                pEditableColumnField="cantidad_pedida">
                <p-cellEditor>
                  <ng-template pTemplate="input">

                    <input pInputText type="number" [(ngModel)]="products.cantidad_pedida" min="0"
                      id="inputCatalogoCliente" (input)="onInputChange(products, $event.target.value)">

                    <ng-container *ngIf="products?.cumpleEmp === false">
                      <input pInputText type="number" [(ngModel)]="products.cantidad_pedida" min="0"
                        id="inputCatalogoCliente" (input)="onInputChange(products, $event.target.value)"
                        style="color: rgba(0, 0, 255, 0.824);">
                    </ng-container>

                    <ng-container *ngIf="products?.cumpleMin === false">
                      <input pInputText type="number" [(ngModel)]="products.cantidad_pedida" min="0"
                        id="inputCatalogoCliente" (input)="onInputChange(products, $event.target.value)"
                        style="color: rgba(255, 0, 0, 0.824);">
                    </ng-container>
                  </ng-template>

                  <ng-template pTemplate="output">
                    {{ products.cantidad_pedida }}
                  </ng-template>
                </p-cellEditor>
              </td> -->

              <!-- COLUMNA CANTIDAD -->
              <td class="center1" [pEditableColumn]="products.cantidad" pEditableColumnField="cantidad">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input pInputText type="number" [(ngModel)]="products.cantidad" min="0" id="input_cantidad"
                    (change)="onInputChangecantidadChangeMatrix(products, $event.target.value);">                    
                  </ng-template>

                  <ng-template pTemplate="output">
                    <!-- ESTO ES CUMPLE PARA NEGATIVOS Y POSITIVOS -->
                    <ng-container *ngIf="products?.cumple === true">
                      <span>{{ formatNumberTotalSubTOTALES(products.cantidad) }}</span>
                      <!-- <input pInputText type="number" [(ngModel)]="products.cantidad" min="0" id="input_cantidad"
                        (change)="onInputChangecantidadChangeMatrix(products, $event.target.value);"> -->
                    </ng-container>

                    <!-- <ng-container *ngIf="products?.cumpleEmp === false && products?.cumple === true"> -->
                      <!-- <span style="color: rgba(0, 0, 255, 0.824) !important;background-color: #a6a5bb6b;font-weight: 900;">{{ products.cantidad }}</span> -->
                      <!-- <input pInputText type="number" [(ngModel)]="products.cantidad" min="0" id="input_cantidad"
                        (change)="onInputChangecantidadChangeMatrix(products, $event.target.value);"
                        style="color: rgba(0, 0, 255, 0.824);"> -->
                    <!-- </ng-container> -->

                    <!-- <ng-container *ngIf="products?.cumpleMin === false"> -->
                      <!-- <span style="color: #ff0000dc !important;background-color: #a6a5bb6b;font-weight: 900;">{{ products.cantidad }}</span> -->
                      <!-- <input pInputText type="number" [(ngModel)]="products.cantidad" min="0"
                        id="input_cantidad"
                        (change)="onInputChangecantidadChangeMatrix(products, $event.target.value);"
                        style="color: rgba(255, 0, 0, 0.824);"> -->
                    <!-- </ng-container> -->
                  </ng-template>
                </p-cellEditor>
              </td>

              <!-- <td class="right">{{ products.porcen_mercaderia }}</td> -->
              <td class="center1" [pEditableColumn]="products.codtarifa" pEditableColumnField="codtarifa">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input pInputText type="number" min="0" [(ngModel)]="products.codtarifa"
                      id="inputCatalogoPrecioVentaDetalle" [value]="products?.codtarifa"
                      (change)="TPChangeMatrix(products, $event.target.value)"
                      (click)="inputClickedPrecioVenta(products)">
                  </ng-template>

                  <ng-template pTemplate="output">
                    {{ products.codtarifa }}
                  </ng-template>
                </p-cellEditor>
              </td>

              <td class="center1" [pEditableColumn]="products.coddescuento" pEditableColumnField="coddescuento">
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input pInputText type="number" min="0" id="inputCatalogoDescuentoEspecialDetalle"
                      [(ngModel)]="products.coddescuento"
                      [value]="products?.coddescuento"
                      (blur)="onLeaveDescuentoEspecialDetalle($event, products)" 
                      (change)="DEChangeMatrix(products, $event.target.value)"
                      (click)="inputClickedDescuento(products)">
                  </ng-template>

                  <ng-template pTemplate="output">
                    {{ products?.coddescuento }}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td class="right1">{{ formatNumberTotalSub(products.preciolista) }}</td>
              <td class="right1">{{ products.niveldesc }}</td>
              <!-- <td class="right1">{{ products.porcendesc  | json}}</td> -->
              <td class="right1">
                {{ products.preciodesc?.toString()?.replace(',', '.') }}</td>
              <td class="right1">
                {{ products.precioneto?.toString().replace(',', '.') }}</td>
              <td class="right1">
                {{  calcularTotalCantidadXPU(products?.cantidad, products?.precioneto) }}
              </td>
            </tr>
          </ng-template>
        </p-table>
        </mat-tab>

        <mat-tab label="Saldos Negativos">
          <table mat-table [dataSource]="dataSource_negativos" class="mat-elevation-z8" matSort>
            <!-- kit Column -->
            <ng-container matColumnDef="kit">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important"> Kit </th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: center !important; padding: 0 0px 0 0px !important">{{ element.kit }}</td>
            </ng-container>

            <!-- NÂ° Parte Column -->
            <ng-container matColumnDef="nro_partes">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"> NÂ° Parte</th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: center !important; padding: 0 0px 0 0px !important">{{ element.nro_partes }}</td>
            </ng-container>

            <!-- Cod. Item Conjunto Column -->
            <ng-container matColumnDef="coditem_cjto">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important"> Cod. Item Conjunto</th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: center !important; padding: 0 0px 0 0px !important">{{ element.coditem_cjto }}</td>
            </ng-container>

            <!-- Cod. Item Conjunto Column -->
            <ng-container matColumnDef="coditem_suelto">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important"> Cod. Item Suelto</th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: center !important; padding: 0 0px 0 0px !important">{{ element.coditem_suelto }}
              </td>
            </ng-container>

            <!-- Cod. Item Conjunto Column -->
            <ng-container matColumnDef="codigo">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important"> Cod. Item</th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: center !important; padding: 0 0px 0 0px !important">{{ element.codigo }}</td>
            </ng-container>

            <!-- Cod. Item Conjunto Column -->
            <ng-container matColumnDef="descitem">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important"> DescripciÃ³n - Medida
              </th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: left !important; padding: 0 0px 0 0px !important">{{ element.descitem }}</td>
            </ng-container>

            <!-- Cantidad Column -->
            <ng-container matColumnDef="cantidad">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important"> Cant. </th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos" style="text-align: center !important; padding: 0 0px 0 0px
                !important">{{ formatNumberTotalSubTOTALES(element.cantidad) }}</td>
            </ng-container>

            <!-- Cantidad Pedida en Conjunto Column -->
            <ng-container matColumnDef="cantidad_conjunto">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important"> Cant. Pedida en
                Conjunto </th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos" style="text-align: right !important; padding: 0 0px 0 0px
                !important">{{ formatNumberTotalSubTOTALES(element.cantidad_conjunto) }}
              </td>
            </ng-container>

            <!-- CSaldo Real Column -->
            <ng-container matColumnDef="saldo_sin_descontar_reservas">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important"> Saldo Real </th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: right !important;">
                {{ formatNumberTotalSubTOTALES(element.saldo_sin_descontar_reservas) }}</td>
            </ng-container>

            <!-- Cantidad Pedida en Suelto Column -->
            <ng-container matColumnDef="cantidad_suelta">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important"> Cant. Pedida en Suelto
              </th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: right !important; padding: 0px 2px 0px 9px !important;">
                {{ formatNumberTotalSubTOTALES(element.cantidad_suelta) }}
              </td>
            </ng-container>

            <!-- Cantidad Reserva Conjunto Column -->
            <ng-container matColumnDef="cantidad_reservada_para_cjtos">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important">Cant. Reserva Conjunto
              </th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: right !important;">
                {{ formatNumberTotalSubTOTALES(element.cantidad_reservada_para_cjtos) }}</td>
            </ng-container>

            <!-- Cantidad Reserva Conjunto Column -->
            <ng-container matColumnDef="saldo_descontando_reservas">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important">Saldo Para Venta Suelta
              </th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: right !important;">
                {{ formatNumberTotalSubTOTALES(element.saldo_descontando_reservas) }}</td>
            </ng-container>

            <!-- Observacion Column -->
            <ng-container matColumnDef="obs">
              <th mat-header-cell *matHeaderCellDef class="mat-column-negativos"
                style="padding: 0 0px 0 0px !important">Obs. </th>
              <td mat-cell *matCellDef="let element" class="mat-column-negativos"
                style="text-align: center !important; padding: 0 0px 0 0px !important">
                <ng-container *ngIf="element.obs === 'Genera Negativo'; else obs1 ">
                  <strong style="color: red;">{{ element.obs }}</strong>
                </ng-container>
                <ng-template #obs1>
                  <strong style="color: green;">{{ element.obs }}</strong>
                </ng-template>
              </td>
            </ng-container>
            <mat-header-row *matHeaderRowDef="displayedColumnsNegativos"></mat-header-row>
            <mat-row *matRowDef="let row; columns: displayedColumnsNegativos;"></mat-row>
          </table>

          <div class="row fixed-bottom-bar" style="background-color: #000000 !important;">
            <div class="col-md" style="float: left;">
              <mat-slide-toggle (click)="negativosTodosFilterToggle()" [checked]="toggleTodosNegativos">
                <span style="color:#ff8000 !important">Todos los Items</span>
              </mat-slide-toggle>
            </div>
            <div class="col-md" style="float: left;">
              <mat-slide-toggle (click)="negativosPositivosFilterToggle()" [checked]="togglePositivos">
                <span style="color:#ff8000 !important">Solo Items NO Generan Saldos Negativos</span>
              </mat-slide-toggle>
            </div>
            <div class="col-md" style="float: left;">
              <mat-slide-toggle (click)="negativosNegativosFilterToggle()" [checked]="toggleNegativos"><span
                  style="color:#ff8000 !important">Saldo
                  Items Que SI Generan Saldos Negativos</span>
              </mat-slide-toggle>
            </div>
          </div>
        </mat-tab>

        <mat-tab label="Limites Venta Maxima">
          <table mat-table [dataSource]="dataSourceLimiteMaximoVentas" class="mat-elevation-z8" matSort>
            <!-- CÃ³digo Item  Column -->
            <ng-container matColumnDef="codigo">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas"> Item </th>
              <td mat-cell *matCellDef="let element; let i = index" class="mat-column-max-ventas"
                [ngClass]="{'selected-row': selectedRowIndex === i}"
                style="text-align: center !important; padding: 0 0px 0 0px !important;cursor:pointer">{{ element.codigo }}</td>
                <!-- (click)="getDiasControl(element.codigo)">{{ element.codigo }}</td> -->
            </ng-container>

            <!-- Descripcion Medida Column -->
            <ng-container matColumnDef="descripcion">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas"> DescripciÃ³n Medida </th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas"
                style="text-align: left !important; padding: 0 0px 0 0px !important">{{ element.descripcion }}</td>
            </ng-container>

            <!-- Cantidad Aprobada Anterior Column -->
            <ng-container matColumnDef="cantidad_pf_anterior">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">Cant. Aprobada Anterior
              </th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas" style="text-align: center !important; padding: 0 0px 0 0px
                !important">{{ element.cantidad_pf_anterior }}</td>
            </ng-container>

            <!-- Cantidad Actual Column -->
            <ng-container matColumnDef="cantidad">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">Cant. Actual
              </th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas" style="text-align: right !important; padding: 0 0px 0 0px
                !important">{{ element.cantidad }}</td>
            </ng-container>

            <!-- Cantidad Total Column -->
            <ng-container matColumnDef="cantidad_pf_total">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">Cant. Total</th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas"
                style="text-align: center !important; padding: 0 0px 0 0px !important">
                {{ element.cantidad_pf_total  }}
              </td>
            </ng-container>

            <!-- % de Venta Column -->
            <ng-container matColumnDef="porcen_venta">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">% de Venta</th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas" style="text-align: center !important; padding: 0 0px 0 0px
                !important">{{ element.porcen_venta }}</td>
            </ng-container>

            <!-- Codigo Descuento Especial Column -->
            <ng-container matColumnDef="cod_desct_esp">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">Cod. Descuento Especial
              </th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas"
                style="text-align: center !important; padding: 0 0px 0 0px !important">{{ element.coddescuento }}</td>
            </ng-container>

            <!-- Precio Column -->
            <ng-container matColumnDef="precio">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">Precio</th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas"
                style="text-align: center !important; padding: 0 0px 0 0px !important"> </td>
            </ng-container>

            <!-- Saldo Column -->
            <ng-container matColumnDef="saldo">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">Saldo</th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas" style="text-align: right !important; padding: 0 0px 0 0px
                !important">{{ formatNumberTotalSubTOTALES(element.saldo) }}</td>
            </ng-container>

            <!-- % Max. Ventas Column -->
            <ng-container matColumnDef="porcen_maximo">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">% Max. Ventas</th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas"
                style="text-align: center !important; padding: 0 0px 0 0px !important">
                {{ formatNumberTotalSubTOTALES(element.porcen_maximo) }}
              </td>
            </ng-container>

            <!-- Cantidad Max. Ventas Column -->
            <ng-container matColumnDef="cantidad_max_venta">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">Cant. Max. Ventas</th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas" style="text-align: right !important; padding: 0 0px 0 0px
                !important">{{ formatNumberTotalSubTOTALES(element.cantidad_permitida_seg_porcen) }}</td>
            </ng-container>

            <!-- Empaque Column -->
            <ng-container matColumnDef="empaque_precio">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">Empaque Seg/Precio</th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas" style="text-align: center !important; padding: 0 0px 0 0px
                !important">{{ element.empaque_precio }}
              </td>
            </ng-container>

            <!-- <ng-container matColumnDef="pasa_limite">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">Â¿Pasa el % Venta?</th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas" style="text-align: center !important; padding: 0 0px 0 0px
                !important">

                <ng-container
                  *ngIf="formatNumberTotalSubTOTALES(element.cantidad) > formatNumberTotalSubTOTALES(element.cantidad_permitida_seg_porcen) ;else prctvt">
                  <strong style="color: red;">SI</strong>
                </ng-container>
                <ng-template #prctvt>
                  <strong style="color: green;">NO</strong>
                </ng-template>
                Lo que estas pidiendo: {{element.cantidad }} - Lo que puedes vender:
                {{element.cantidad_permitida_seg_porcen}}
              </td>
            </ng-container> -->

            <!-- Observaciones Column -->
            <ng-container matColumnDef="obs">
              <th mat-header-cell *matHeaderCellDef class="mat-column-max-ventas">Obs.</th>
              <td mat-cell *matCellDef="let element" class="mat-column-max-ventas" [ngSwitch]="element.obs">
                <ng-container *ngSwitchCase="'Cumple'">
                  <strong style="color: green;">{{ element.obs }}</strong>
                </ng-container>
                <ng-container *ngSwitchCase="'No hay Saldo!!!'">
                  <strong style="color: red;">{{ element.obs }}</strong>
                </ng-container>
                <ng-container *ngSwitchCase="'No cumple'">
                  <strong style="color: red;">{{ element.obs }}</strong>
                </ng-container>
                <ng-container *ngSwitchDefault>
                  <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1"
                    (click)="modalDetalleObservaciones(element.obs, element.ObsDetalle );">
                    <span><i class="fa fa-eye" aria-hidden="true" style="color: #ffc107;"></i> Ver Detalles
                      Obs.</span>
                  </button>
                </ng-container>
              </td>
            </ng-container>

            <mat-header-row *matHeaderRowDef="displayedColumnsLimiteMaximoVentas"></mat-header-row>
            <mat-row *matRowDef="let row; columns: displayedColumnsLimiteMaximoVentas;"></mat-row>
          </table>

          <div class="row fixed-bottom-bar" style="background-color: #000000 !important;">
            <div class="col-md" style="float: left;">
              <mat-slide-toggle (click)="maximoVentasAllFilterToggle()" [checked]="toggleTodosMaximoVentas">
                <span style="color:#fbd800 !important">Todos los Items</span>
              </mat-slide-toggle>
            </div>
            <div class="col-md" style="float: left;">
              <mat-slide-toggle (click)="maxmoVentasNOSobrepasanFilterToggle()"
                [checked]="toggleMaximoVentasNoSobrepasan">
                <span style="color:#fbd800 !important">Solo Items No Sobre Pasan Limite
                  Max. de Ventas</span>
              </mat-slide-toggle>
            </div>
            <div class="col-md" style="float: left;">
              <mat-slide-toggle (click)="maxmoVentasSISobrepasanFilterToggle()"
                [checked]="toggleMaximoVentaSobrepasan">
                <span style="color:#fbd800 !important">Solo Items Si Sobren Pasan Limite Max. de
                  Venta</span>
              </mat-slide-toggle>
            </div>
            <div class="col-md" style="float: right !important;">
              <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1" type="button"
                (click)="validarProformaSoloMaximoVenta();" style="float: right !important;">
                <span><i class="fa fa-check" aria-hidden="true" style="color: #ffc107;"></i> Validar Porcentaje Vta
                  Permitido</span>
              </button>
            </div>
          </div>
        </mat-tab>

        <mat-tab label="Resultado de Validacion">
          <table mat-table [dataSource]="dataSource_validacion" class="mat-elevation-z8"
          style="white-space: normal !important;" multiTemplateDataRows>
          <!-- orden Column -->
          <ng-container matColumnDef="codControl">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion text-center"> Cod. </th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion"
              style="text-align: center !important; padding: 0 0px 0 0px !important"> {{ element.CodControl }} </td>
          </ng-container>

          <!-- descripcion Column -->
          <ng-container matColumnDef="descripcion" style="width: 200px !important;">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion">
              DescripciÃ³n </th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion" style="text-align: left !important; 
            padding: 0 0px 0 0px !important;">{{ element.Descripcion }}</td>
          </ng-container>

          <!-- valido Column -->
          <ng-container matColumnDef="valido">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion text-center"> Valido </th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion"
              style="text-align: center !important; padding: 0 0px 0 0px !important;color:rgb(202, 6, 6)">
              <ng-container *ngIf="element.Valido === 'SI'; else validoo">
                <strong style="color:green">SI</strong>
              </ng-container>
              <ng-template #validoo>
                <strong style="color:red">NO</strong>
              </ng-template>
            </td>
          </ng-container>

          <!-- cod_servicio Column -->
          <ng-container matColumnDef="cod_servicio">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion"> Cod. Servicio </th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion"
              style="text-align: center !important; padding: 0 0px 0 0px !important">{{ element.CodServicio }}</td>
          </ng-container>

          <!-- Descuento Servicio Column -->
          <ng-container matColumnDef="desct_servicio">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion"> Desc. Servicio </th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion"
              style="text-align: center !important; padding: 0 0px 0 0px !important">{{ element.DescServicio }}
            </td>
          </ng-container>

          <!-- Dato A Column -->
          <ng-container matColumnDef="datoA">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion"> Dato
              A </th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion"
              style="text-align: center !important; padding: 0 0px 0 0px !important">{{ element.DatoA }} </td>
          </ng-container>

          <!-- Dato B Column -->
          <ng-container matColumnDef="datoB">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion"> Dato
              B </th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion"
              style="text-align: center !important; padding: 0 0px 0 0px !important">{{ element.DatoB }}</td>
          </ng-container>

          <!-- Clave Servicio Column -->
          <ng-container matColumnDef="clave_servicio">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion">Clave Servicio</th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion"
              style="text-align: center !important; padding: 0 0px 0 0px !important">

              <ng-container *ngIf="element.ClaveServicio === 'AUTORIZADO';else claveelse">
                <p style="color: green;"><strong>{{ element.ClaveServicio }}</strong></p>
              </ng-container>
              <ng-template #claveelse>
                <p style="color: red;">{{ element.ClaveServicio }}</p>
              </ng-template>
            </td>
          </ng-container>

          <!-- Resolver Column -->
          <ng-container matColumnDef="resolver">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion">
              Resolver</th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion"
              style="text-align: center !important; padding: 0 0px 0 0px !important">
              <ng-container *ngIf="element.Accion === 'Pedir_Servicio' && element.CodServicio !== '0'">
                <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1"
                  style="margin-block-start: 9px;"
                  (click)="resolverValidacionEnValidar(element.DatoA, element.DatoB, element.DescServicio, element.CodServicio, element);">
                  <span><i class="fa fa-magic" aria-hidden="true" style="color: #ffc107;"></i></span>
                </button>
              </ng-container>

              <ng-container *ngIf="element.Accion === 'Confirmar_SiNo'">
                <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1"
                  style="margin-block-start: 9px;" (click)="resolverValidacionEnValidarMensaje(element);">
                  <span><i class="fa fa-magic" aria-hidden="true" style="color: #ffc107;"></i></span>
                </button>
              </ng-container>

              <!-- <ng-container *ngIf="element.DatoA != '' && element.DatoB !='' ">
                <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1"
                  style="margin-block-start: 9px;" (click)="resolverValidacionEnValidarMensaje(element);">
                  <span><i class="fa fa-magic" aria-hidden="true" style="color: #ffc107;"></i></span>
                </button>
              </ng-container> -->
            </td>
          </ng-container>

          <!-- Detalle Obs. Column -->
          <ng-container matColumnDef="detalle_observacion">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion">
              Detalle Obs.</th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion"
              style="text-align: center !important; padding: 0 0px 0 0px !important">
              <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1"
                style="margin-block-start: 10px;margin-block-end: 10px;"
                (click)="modalDetalleObservaciones(element.Observacion, element.ObsDetalle);">
                <span><i class="fa fa-eye" aria-hidden="true" style="color: #ffc107;"></i>
                  Obs.</span>
              </button>
            </td>
          </ng-container>

          <!-- Validar Column -->
          <ng-container matColumnDef="validar">
            <th mat-header-cell *matHeaderCellDef class="mat-column-resultado-validacion">
              Validar</th>
            <td mat-cell *matCellDef="let element" class="mat-column-resultado-validacion"
              style="text-align: center !important; padding: 0 0px 0 0px !important">
              <button mat-raised-button class="btn btn-outline-secondary form-control-sm mr-1"
                (click)="validarDeUno(element);">
                <span><i class="fa fa-check" aria-hidden="true" style="color: #ffc107;"></i></span>
              </button>
            </td>
          </ng-container>
          <mat-header-row *matHeaderRowDef="displayedColumns_validacion"></mat-header-row>
          <mat-row *matRowDef="let row; columns: displayedColumns_validacion;"></mat-row>
        </table>

        <div class="row fixed-bottom-bar">
          <div class="col-md" style="float: left;">
            <mat-slide-toggle (click)="validacionesTodosFilterToggle()" [checked]="toggleValidacionesAll">
              <span style="color:#00db00 !important">Todos </span>
            </mat-slide-toggle>
          </div>
          <div class="col-md" style="float: left;">
            <mat-slide-toggle (click)="validacionesValidosFilterToggle()" [checked]="toggleValidos">
              <span style="color:#00db00 !important">Solo Validos</span>
            </mat-slide-toggle>
          </div>
          <div class="col-md" style="float: left;">
            <mat-slide-toggle (click)="validacionesNOValidosFilterToggle()" [checked]="toggleNoValidos">
              <span style="color:#00db00 !important">Solo No Validos</span>
            </mat-slide-toggle>
          </div>
        </div>
        </mat-tab>

        <mat-tab label="Observaciones">
          <div style="background-color: black;color: yellow;">
            <span>RESULTADO DE ENVIO DE FACTURA</span>
          </div>
          <p-listbox [options]="eventosLogs" [(ngModel)]="eventosLogs" optionLabel="label" [metaKeySelection]="false" scrollHeight="250px">
          </p-listbox>
          <br><br>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>

  <!-- inicioPiePagina -->
    <div mat-dialog-footer class="footersito">
      <div class="row">
        <div class="col-md-10" style="padding-left: 0px !important;">
          <mat-tab-group class="miTabGroupProformaFooter" style="border-style: ridge;" #tabGroupfooter>
            <form class="example-form" [formGroup]="FormularioData">
              <mat-tab label="Destino">
                <div class="row">
                  <div class="col-md-8">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text form-control-sm"
                          style="padding: 8px 6px 0px 41px;border: 0 !important;">
                          <u> Transporte </u>
                        </span>
                      </div>
                      <div style="width: 444px !important;">
                        <input type="text" class="form-control form-control-sm" 
                        formControlName="transporte" [(ngModel)]="transporte" style="text-align: left !important;">
                      </div> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                      <span style="margin-top: 5px !important;"> <strong>Peso: </strong> {{ formatNumberTotalSubTOTALES(peso) }}</span>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-4">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text form-control-sm"
                          style="padding: 10px 7px 0px 6px;border: 0 !important;">
                          <u>Flete Pagado Por</u>
                        </span>
                      </div>
                      <input type="text" class="form-control form-control-sm" formControlName="fletepor"
                      [(ngModel)]="fletepor" style="text-align: left !important;">
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="input-group-prepend">
                      <span class="input-group-text form-control-sm"
                        style="padding: 5px 0px 0px 0px;border: 0 !important;"><u>Orden de Compra</u></span>
                      <input type="text" class="form-control form-control-sm" style="margin-left: 3px;"
                        formControlName="tipoentrega">
                    </div>
                  </div>
                  <div class="col-md-2">
                    <div class="input-group-prepend">
                      <span class="input-group-text form-control-sm" style="height: calc(1.5rem + 5px) !important;">
                        <u>T. de C</u></span>
                        <input type="text" class="form-control form-control-sm" [(ngModel)]="tipo_cambio_moneda_catalogo"
                        formControlName="tdc" readOnly="true" style="text-align: left !important;">
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-8">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text form-control-sm"
                          style="height: calc(2.3rem + 5px) !important;padding: 8px 0px 0px 49px;border: 0 !important;">
                          <u>DirecciÃ³n</u></span>
                      </div>
                      <textarea class="form-control" [(ngModel)]="direccion" rows="1" id="inputCatalogoDireccion"
                        style="font-size: 0.79rem !important;margin-left: 6px;" formControlName="direccion" readonly>
                      </textarea>

                      <div class="input-group-append">
                        <button class="btn btn-outline-primary form-control-sm" type="button"
                          (click)="modalClientesDireccion(codigo_cliente_catalogo_real);"
                          style="border-color: #093070;height: calc(2.3rem + 5px) !important;">
                          <i class="fa fa-cog"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </mat-tab>

              <mat-tab label="Forma de Pago"><br>
                <div class="row">
                  <div class="col-md-3">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text form-control-sm" style="padding: 8px 6px 0px 41px;border: 0 !important;">
                          <u> Formas de Pago </u>
                        </span>
                      </div>
                      <select class="custom-select1 form-control-sm" style="margin-left: 5px;" formControlName="forma_pago"
                        [(ngModel)]="forma_pago" [value]=forma_pago>
                        <option [value]=forma_pago selected>{{ forma_pago }} - {{forma_pago_descripcion}} </option>
                      </select>
                    </div>
                  </div>
                </div>
              </mat-tab>
              
              <mat-tab label="Anticipo Contado"><br>
                <div class="row">
                  <div class="col-md-6">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text form-control-sm"
                          style="padding: 8px 6px 0px 20px;border: 0 !important;">
                          <u> Anticipo Para Venta a Contado </u>
                        </span>
                      </div>

                      <select class="custom-select1 form-control-sm" style="margin-left: 5px;" *ngFor="let catalogo_anticiposs of catalogo_anticipos" 
                        formControlName="idanticipo" [(ngModel)]="id_catalogo_anticipos">
                        <option [value]="catalogo_anticiposs.id">{{ catalogo_anticiposs.id }} </option>
                      </select>

                      <input type="text" formControlName="numeroidanticipo" [(ngModel)]="num_id_anticipo_get_buscador">
                      
                      <button class="btn btn-outline-secondary form-control-sm" type="button" style="color:black;"
                      (click)="modalBuscadorAnticipos()">
                        <i class="fa fa-binoculars" style="color:black;" aria-hidden="true"></i> Buscar
                      </button>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text form-control-sm"
                        style="padding: 7px 11px 0px 79px;border: 0 !important;">
                        <u> Monto de Anticipo </u>
                      </span>
                    </div>
                    <input type="number" formControlName="monto_anticipo" [(ngModel)]="monto_anticipo" style="width: 131px;" >
                  </div>
                </div>
              </mat-tab>

              <mat-tab label="Complementaria">
                <div class="row">
                  <div class="col-md-10"><br>
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text form-control-sm"
                          style="padding: 8px 6px 0px 20px;border: 0 !important;">
                          <u> Complementaria de: </u>
                        </span>
                      </div>
                      <input type="text" formControlName="idfc" [(ngModel)]="id_tipo_para_complementar">
                      <button class="btn btn-outline-secondary form-control-sm" type="button" style="color:black;"
                        (click)="modalTipoID();">
                        <i class="fa fa-search" style="color:black;" aria-hidden="true"></i>
                      </button>
                      <input type="text" formControlName="numeroidfc" >
                    </div>
                  </div>
                </div>
              </mat-tab>

              <!-- <mat-tab label="Factura Electronica">
              </mat-tab> -->
            
              <mat-tab label="Pedido Proforma"><br>
                <div class="row">
                  <div class="input-group" style="padding-left: 7px;">
                    <span class="input-group-text form-control-sm">ID</span>
                    <mat-form-field class="mat-mdc-form-field"
                      style="width: 200px !important;">
                      <mat-select [(ngModel)]="num_idd" formControlName="idpf_solurgente">
                        <mat-option *ngFor="let ids_complementar_proformas of ids_complementar_proforma"
                          [value]="ids_complementar_proformas.id">
                          {{ ids_complementar_proformas.id }} - {{ ids_complementar_proformas.descripcion }}
                          <hr>
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
      
                    <div style="width: 15% !important; padding-right: 5px;">
                      <input type="number" placeholder="0" [(ngModel)]="num_id"
                        formControlName="noridpf_solurgente" class="form-control form-control-sm"
                        style="margin-left: 5px;" id="input_search">
                    </div>
                    <div class="input-group-append">
                      <button type="button" class="btn btn-outline-primary form-control-sm" (click)="transferirProforma()"
                        style="border-color: #ffc107;" disabled>
                        <i class="fa fa-search"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </mat-tab>

              <mat-tab label="Desct. Promocion">
                <div class="row p-2">
                  <div class="col-md">
                    <form class="example-form" [formGroup]="FormularioData">
                      <div class="input-group">
                        <div class="input-group-prepend">
                          <span class="input-group-text form-control-sm"
                            style="margin-left: 15px;border: 0 !important;"><u>Aplicar Desct. de Nivel
                              Actuales del Cliente</u></span>
                        </div>
                        <select style="margin-left: 5px;" [(ngModel)]="desct_nivel_actual" [value]="desct_nivel_actual"
                          style="width: 18%;" formControlName="niveles_descuento">
                          <option value="ACTUAL" selected>ACTUAL</option>
                          <option value="ANTERIOR">ANTERIOR</option>
                        </select>
                      </div>

                      <div class="input-group">
                        <div class="input-group-prepend">
                          <span class="input-group-text form-control-sm"
                            style="padding: 10px 0px 0px 116px;border: 0 !important;">
                            <u>Precio Principal del Pedido</u>
                          </span>
                        </div>
                        <input type="number" style="margin-left: 6px;" [value]="tarifaPrincipal_value" readonly>
                        <div class="input-group-append">
                          <button class="btn btn-outline-primary form-control-sm" type="button"
                            (click)="getPrecioMayorEnDetalle();" style="border-color: #ffc107;">
                            <i class="fa fa-check"></i>
                          </button>
                        </div>
                      </div>
                    </form>
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text form-control-sm"
                          style="padding: 10px 0px 0px 129px;border: 0 !important;">
                          <u>Tipo Descuento de Nivel</u></span>
                      </div>

                      <select style="margin-left: 5px;" [(ngModel)]="tipo_desct_nivel">
                        <option *ngFor="let valor_desct_nivels of valor_desct_nivel"
                          [value]="valor_desct_nivels.desc_nivel">{{ valor_desct_nivels.desc_nivel }}</option>
                      </select>&nbsp;

                      <div class="input-group-append">
                        <button class="btn btn-outline-primary form-control-sm" type="button"
                          style="border-color: #ffc107;" (click)="aplicarDescuentoNivel()"
                          readonly="!tarifaPrincipal_value">
                          <i class="fa fa-cog"> Aplicar Descuento</i>
                        </button>
                      </div>
                    </div>

                  </div>
                </div>
              </mat-tab>
           
              <mat-tab label="Totales">
              </mat-tab>
           </form>
          </mat-tab-group>
        </div>

        <!-- inicioTotales -->
        <div class="col-md-2" style="padding-left: 0px !important;">
          <form class="example-form" [formGroup]="FormularioData">
            <div class="row" style="height: calc(1.4rem + 2px) !important;">
              <div class="col">
                <span class="input-group-text form-control-sm" style="border: 0 !important;padding: 5px 13px 0px 7px;"><u>
                    Sub Total</u>
                </span>
              </div>
              <div class="col text-right" style="border: 1px #6c757d solid;border-radius: 6px;">
                <span>{{ formatNumberTotalSubTOTALES(subtotal) }}</span>
                <input type="text" [(ngModel)]="subtotal" formControlName="subtotal" [hidden]="true">
              </div>

              <div class="col text-right">
                <button class="btn btn-outline-primary form-control-sm" type="button" style="border-color: #093070;"
                  (click)="modalSubTotal();">
                  <mat-icon>monetization_on</mat-icon>
                </button>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <span class="input-group-text form-control-sm"
                  style="padding: 5px 2px 0px 0px;border: 0 !important;"><u>(+) Recargos</u></span>
              </div>
              <div class="col text-right" style="border: 1px #6c757d solid;border-radius: 6px;">
                <span>{{ formatNumberTotalSubTOTALES(recargos) }} </span>
                <input type="text" [(ngModel)]="recargos" formControlName="recargos" [hidden]="true">
              </div>
              <div class="col text-right">
                <button class="btn btn-outline-primary form-control-sm" type="button" style="border-color: #093070;"
                  (click)="modalRecargos();" disabled="true">
                  <!-- [disabled]="total === 0" -->
                  <mat-icon>monetization_on</mat-icon>
                </button>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <span class="input-group-text form-control-sm"
                  style="padding: 0px 0px 0px 0px;border: 0 !important;"><u>(-) Descuento</u></span>
              </div>
              <div class="col text-right" style="border: 1px #6c757d solid;border-radius: 6px;">
                <span> {{ formatNumberTotalSubTOTALES(des_extra) }}</span>
                <input type="number" [(ngModel)]="des_extra" formControlName="des_extra" hidden="true">
              </div>
              <div class="col text-right">
                <button class="btn btn-outline-primary form-control-sm" type="button" style="border-color: #093070;"
                  (click)="modalDescuentosTotales();">
                  <mat-icon>monetization_on</mat-icon>
                </button>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <span class="input-group-text form-control-sm"
                  style="padding: 5px 0px 0px 19px;border: 0 !important;padding-right: 15px;"><u>(+) IVA</u></span>
              </div>
              <div class="col text-right" style="border: 1px #6c757d solid;border-radius: 6px;">
                <span>{{ formatNumberTotalSubTOTALES(iva) }}</span>
                <input type="text" [(ngModel)]="iva" formControlName="iva" [hidden]="true">
              </div>
              <div class="col text-right">
                <button class="btn btn-outline-primary form-control-sm" type="button" style="border-color: #093070;"
                  (click)="modalIva();">
                  <mat-icon>monetization_on</mat-icon>
                </button>
              </div>
            </div>

            <div class="row" style="height: calc(1.4rem + 2px) !important;">
              <div class="col">
                <span class="input-group-text form-control-sm"
                  style="padding: 5px 0px 0px 16px;border: 0 !important;padding-right: 12px;"><u>(=) Total</u></span>
              </div>
              <div class="col text-right" style="border: 1px #6c757d solid;border-radius: 6px;">
                <span>{{ formatNumberTotalSubTOTALES(total) }}</span>
                <input type="text" [(ngModel)]="total" formControlName="total" [hidden]="true">
              </div>
              <div class="col text-right">
                <button class="btn btn-outline-primary form-control-sm" type="button" style="border-color: #093070;"
                  (click)="totabilizar();">
                  <mat-icon>monetization_on</mat-icon>
                </button>
              </div>
            </div>
          </form>
        </div>
        <!-- finTotales -->
      </div>
    
      <div class="row">
        <div class="col-md-10">
          <!-- Saldos -->
          <div class="row pl-2">
            <input type="text" class="inputsSaldos inputsSaldos2"
              value="{{ almacn_parame_usuario_almacen }}: {{ saldoItem }}"
              style="font-size: 0.8rem;width:9%;background-color: black;color: rgb(230, 230, 0);" [readOnly]="true"
              placeholder="0.00">

            <ng-container *ngFor="let almacenes_saldoss of almacenes_saldos">
              <span style="padding: 3px 5px 0px 3px;"><strong>{{ almacenes_saldoss.codalmsald1 }}:</strong></span>
              <input type="text" class="inputsSaldos inputsSaldos2" [ngModel]="saldo_modal_total_1"
                style="font-size: 0.8rem;width:7%;background-color: black;color: #00c600;cursor: pointer;"
                (click)="modalSaldos(almacenes_saldoss.codalmsald1, 1);" [readOnly]="true" placeholder="0.00">

              <span style="padding: 3px 5px 0px 3px;"><strong>{{ almacenes_saldoss.codalmsald2 }}:</strong></span>
              <input type="text" class="inputsSaldos inputsSaldos2" [ngModel]="saldo_modal_total_2"
                style="font-size: 0.8rem;width:7%;background-color: black;color: #00c600;cursor: pointer;"
                (click)="modalSaldos(almacenes_saldoss.codalmsald2, 2);" [readOnly]="true" placeholder="0.00">

              <span style="padding: 3px 5px 0px 3px;"><strong>{{ almacenes_saldoss.codalmsald3 }}:</strong></span>
              <input type="text" class="inputsSaldos inputsSaldos2" [ngModel]="saldo_modal_total_3"
                style="font-size: 0.8rem;width:7%;background-color: black;color: #00c600;cursor: pointer;"
                (click)="modalSaldos(almacenes_saldoss.codalmsald3, 3);" [readOnly]="true" placeholder="0.00">

              <span style="padding: 3px 5px 0px 3px;"><strong>{{ almacenes_saldoss.codalmsald4 }}:</strong></span>
              <input type="text" class="inputsSaldos inputsSaldos2" [ngModel]="saldo_modal_total_4"
                style="font-size: 0.8rem;width:7%;background-color: black;color: #00c600;cursor: pointer;"
                (click)="modalSaldos(almacenes_saldoss.codalmsald4, 4);" [readOnly]="true" placeholder="0.00">

              <span style="padding: 3px 5px 0px 3px;"><strong>{{ almacenes_saldoss.codalmsald5 }}:</strong></span>
              <input type="text" class="inputsSaldos inputsSaldos2" [ngModel]="saldo_modal_total_5"
                style="font-size: 0.8rem;width:7%;background-color: black;color: #00c600;cursor: pointer;"
                (click)="modalSaldos(almacenes_saldoss.codalmsald5, 5);" [readOnly]="true" placeholder="0.00">
            </ng-container>
          </div>
          <!-- finSaldos -->

          <!-- Empaques Minimo-->
          <div class="row">
            <div class="input-group" style="width: 20% !important;">
              <span class="input-group-text form-control-sm">Empaque Minimo</span>

              <div type="text" class="form-control form-control-sm inputsSaldos"
                style="width: 1% !important;text-align: right;">
                {{ item_obtenido.empaqueminimo }}
              </div> &nbsp;|&nbsp;

              <!-- <span class="input-group-text form-control-sm">Peso Minimo</span>
              <div type="text" class="form-control form-control-sm inputsSaldos"
                style="width: 1% !important;text-align: right;">
                {{ item_obtenido.pesominimo | number:'1.3-3' }}
              </div> -->

              <!-- <ng-container *ngIf="item_obtenido.penalizadoText === '';else penalizado">
                <div type="text" class="form-control form-control-sm inputsSaldos"
                  style="width: 1% !important;text-align: right;">
                  no penalizado
                </div> &nbsp;|&nbsp;
              </ng-container> -->

              <!-- <ng-template #penalizado>
                <div type="text" class="form-control form-control-sm inputsSaldos"
                  style="width: 1% !important;text-align: right;">
                  {{ item_obtenido.penalizadoText }}
                </div> &nbsp;|&nbsp;
              </ng-template> -->

              <!-- <div type="text" class="form-control form-control-sm inputsSaldos"
                style="width: 8.5% !important;text-align: center;">
                {{ porcen_item }}
              </div> -->             
            </div>
            <div class="input-group" style="padding-left: 7px;">
              <span class="input-group-text form-control-sm">Empaques</span>

              <ng-container *ngIf="!empaque_view; else empaque_view">
                <div type="text" class="form-control form-control-sm inputsSaldos"> </div>
              </ng-container>&nbsp;

              <ng-template #empaque_view>
                <div *ngFor="let empaquesItems of empaquesItem">
                  <div type="text" class="form-control form-control-sm inputsSaldos" style="width: 100% !important;">
                    ({{empaquesItems.codigo}}){{empaquesItems.descripcion}}-{{empaquesItems.cantidad }}
                  </div>
                </div>
              </ng-template>
            </div><br>
          </div><br>
          <!-- finempaque Minimo-->
        </div><br>

        <div class="col-md-2">
        </div>
      </div>
      <div>
        <app-footer></app-footer>
        <app-control-sidebar></app-control-sidebar>
      </div>      
    </div>
  <!-- finpiePagina -->
</section>
